---
title: "Portfolio 1"
---

> Fall 2025, I collected some data on earthworms crop-gizzard smooth muscle contractions and how extracellular dopamine at different concentrations affect the frequency and amplitude of the contractions. I made the graphs with SPSS initially, but they were called ugly by my instructor, which I agree. I ended up making the graphs in excel, but now I want to remake them in R.

```{r load-packages, warning = FALSE, message=FALSE}
library(tidyverse) 
library(tidyr)
library(readxl)
setwd("D:/Yiwei/WFU/Senior/Spring 2026/PSY 279 B/Portfolio_ds4p/")
the.data <- read_excel("Crop-Gizzard.xlsx")
```

Here, I first tried to plot a bar graph with three bars representing the average contraction frequency of the crop-gizzard under three different dopamine concentrations: vehicle, 20nM, and 40nM.
```{r plot a bar plot for frequency}
vehicle_freq_mean <- mean(the.data$frequency[the.data$dose == 1])
vehicle_freq_sd <- sd(the.data$frequency[the.data$dose == 1])

low_freq_mean <- mean(the.data$frequency[the.data$dose == 2])
low_freq_sd <- sd(the.data$frequency[the.data$dose == 2])

high_freq_mean <- mean(the.data$frequency[the.data$dose == 3])
high_freq_sd <- sd(the.data$frequency[the.data$dose == 3])

the.data <- the.data %>% 
  mutate(
    dose = case_when(
      dose == 1 ~ "vehicle",
      dose == 2 ~ "20nM",
      dose == 3 ~ "40nM"
    )
  )

#the.data %>% 
#  ggplot() +
#  geom_bar(aes(x = dose,
#               y = c(vehicle_freq_mean, low_freq_mean, high_freq_mean),
#               stat = "identity"
#               )
#  ) +
#  geom_errorbar((aes(x = dose,
#                     y = c(vehicle_freq_sd, low_freq_sd, high_freq_sd)
#                     )
#                 )
#  ) +
#  geom_point(aes(x = dose,
#                 y = frequency
#                 )
#  )
```

geom_bar() did not like the way I put in the aesthetics. I got an error message saying that "Aesthetics must be either length 1 or the same as the data (21)." and I need to fix the mapping of "y". Next, I will attempt a different way of arragning my data to fix the mapping problem.
```{r}
rm(list = ls())
the.data <- read_excel("Crop-Gizzard.xlsx")

the.data <- the.data %>% 
  mutate(
    dose = case_when(
      dose == 1 ~ "vehicle",
      dose == 2 ~ "20nM",
      dose == 3 ~ "40nM"
    )
  )

veh.data <- the.data %>% 
  filter(dose == "vehicle")

low.data <- the.data %>% 
  filter(dose == "20nM")

high.data <- the.data %>% 
  filter(dose == "40nM")

new.freq.data <- data.frame(
  veh_freq = veh.data$frequency,
  low_freq = low.data$frequency,
  high_freq = high.data$frequency
)

mean_freq <- colMeans(new.freq.data)

new.freq.data %>% 
  ggplot(aes(x = mean_freq[1, ],
      y = mean_freq[2, ]
      )
  )+
  geom_bar(stat = "identity"
    )
  
new.data %>% 
  ggplot(aes(x = ,
             y = c(vehicle_freq_mean, low_freq_mean, high_freq_mean),
             fill = dose
  )) +
  geom_bar(stat = "summary"
  ) +
  geom_errorbar((aes(x = dose,
                     y = c(vehicle_freq_sd, low_freq_sd, high_freq_sd)
                     )
                 )
  ) +
  geom_point(aes(x = dose,
                 y = frequency
                 )
  )
```

ggplot() + 
  geom_bar(aes(x= x_row, y = y_val), df, stat = 'identity') +
  geom_errorbar(aes(x = x_row, ymin=mean-sd, ymax=mean+sd), df, width=.2) +
  geom_point(aes(x = name, y = value, color = name), Book1, size = 5)

the.data %>% 
  ggplot(mapping = aes(x = dose,
                       y = frequency,
                       fill = dose)
         ) +
  geom_point() +
  ggplot()

